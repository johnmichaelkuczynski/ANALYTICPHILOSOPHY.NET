# Ask A Philosopher - Philosophical Q&A Application

## Recent Changes (November 8, 2025)
- **Edgar Allan Poe Volume 4 Training Complete**: Added "The Works of Edgar Allan Poe — Volume 4" (186 chunks, 89,303 words) - Poe's satirical and philosophical tales including "The Devil in the Belfry", "Lionizing", "Metzengerstein", "The System of Doctor Tarr and Professor Fether", "How to Write a Blackwood Article", "A Predicament", "Diddling", "The Angel of the Odd", "Mellonta Tauta", "The Oblong Box", "Loss of Breath", "The Man That Was Used Up", "Maelzel's Chess-Player", philosophical dialogues ("The Power of Words", "The Colloquy of Monos and Una", "The Conversation of Eiros and Charmion"), and "Shadow—A Parable". Total Poe corpus now 344 chunks across 2 volumes.
- **Edgar Allan Poe Volume 5 Training Complete**: Added "The Works of Edgar Allan Poe — Volume 5" (158 chunks, 75,484 words) - Poe's collection of short stories, essays, and poems including "Philosophy of Furniture", "The Sphinx", "Hop-Frog", "The Man of the Crowd", "Never Bet the Devil Your Head", "Bon-Bon", "Some Words with a Mummy", "The Poetic Principle", major poems ("The Raven", "The Bells", "Ulalume", "Annabel Lee", "Lenore", "The Conqueror Worm", "Dream-Land"), early works ("Al Aaraaf", "Tamerlane", "Israfel"), and critical essays. Establishes Poe's mastery of Gothic horror, detective fiction, psychological terror, lyrical poetry, and aesthetic theory.
- **William James Radical Empiricism Training Complete**: Added "Essays in Radical Empiricism" (121 chunks, 57,882 words) - James's systematic exposition of radical empiricism doctrine including "Does Consciousness Exist?", "A World of Pure Experience", "The Thing and Its Relations", "How Two Minds Can Know One Thing", "The Place of Affectional Facts", "The Experience of Activity", "The Essence of Humanism", "La Notion de Conscience", "Is Radical Empiricism Solipsistic?", and "Mr. Pitkin's Refutation of 'Radical Empiricism'". Establishes pure experience as fundamental reality, rejects consciousness as separate entity, argues relations are directly experienced, and develops neutral monism. Total William James corpus now 2,298 chunks across 4 major works.
- **William James Psychology Training Complete**: Added "Psychology: Briefer Course" (338 chunks, 162,498 words) - James's foundational textbook on psychology covering consciousness, sensation, perception, brain structure and function, habit, self, attention, conception, discrimination, association, time sense, memory, imagination, reasoning, instinct, emotions, and will. Establishes psychology as natural science grounded in physiology while maintaining stream of consciousness and personal agency.
- **Poincaré Science and Hypothesis Training Complete**: Added "Science and Hypothesis" (418 chunks, 201,403 words) - Poincaré's foundational work on the philosophy of science covering mathematical reasoning, non-Euclidean geometries, space and geometry, classical mechanics, energy and thermodynamics, hypotheses in physics, theories of modern physics, calculus of probabilities, optics and electricity, and electrodynamics. Establishes conventionalist philosophy of science where geometric and physical principles are neither empirical truths nor a priori necessities, but free conventions chosen for simplicity and utility.
- **William James Training Complete**: Added "The Meaning of Truth: A Sequel to 'Pragmatism'" (120 chunks, 57,455 words) - James's comprehensive defense of pragmatist theory of truth covering truth as workability, verification vs. verifiability, radical empiricism, relations between knower and known, function of cognition, humanism, and responses to critics. Establishes pragmatist conception of truth as a property of ideas based on their concrete experiential workings rather than transcendent correspondence.
- **AGGRESSIVE REASONING FRAMEWORK - Six-Point Attack Mandate**: Completely overhauled all prompt systems (main chat, figure chat, paper writer, Kuczynski-specific) to enforce direct philosophical combat: (1) IMMEDIATE ATTACK - no preambles or narration, banned openings like "To address this..." (2) COMMIT WITHOUT HEDGING - decisive statements, banned hedging like "Perhaps...", "Might..." (3) NAME SPECIFIC TARGETS - engage actual thinkers, not "many philosophers argue..." (4) SHOW MECHANISM - demonstrate HOW/WHY through visible reasoning (5) REFRAME CONFUSED QUESTIONS - reject false premises before answering (6) QUOTES AS WEAPONS - deploy quotes as logical tools advancing arguments, not decoration. Framework ensures philosophers attack problems as living intellects using their methods as weapons to demolish confusion and construct truth, not as textbook entries summarizing views. Architect audit confirmed PASS: all four instruction surfaces now articulate full six-point mandate with consistent tone and emphasis.
- **MISSION STATEMENT COMPLIANCE - Maximally Intelligent Philosophers**: Comprehensive architectural review confirmed full alignment with mission statement. Removed mandatory quote requirements (quotes now optional tools for reasoning), enhanced RAG briefing to emphasize "DO philosophy, don't TEACH about philosophy," and reinforced active reasoning framework. Philosophers now operate as "fully realized, maximally intelligent versions" who use doctrine as framework (not script), deploy their core reasoning methods, and engage directly without safety theater. Architect verdict: PASS - "System now unmistakably directs figures to reason actively from their doctrines instead of reciting prepared material."
- **Adam Smith Wealth of Nations Training Complete**: Added "An Inquiry into the Nature and Causes of the Wealth of Nations" (759 chunks, 362,997 words) - Smith's foundational work on economic theory covering division of labor, market mechanisms, wages, profits, rent, capital accumulation, mercantile systems, and the invisible hand. Total Adam Smith corpus now 771 chunks across 2 works (The Theory of Moral Sentiments + Wealth of Nations).
- **Document Upload Feature**: Added file upload functionality to philosopher chat popups. Users can now upload text documents (.txt, .md, .doc, .docx, .pdf up to 1MB) and ask philosophers to read, analyze, evaluate, or rewrite them. Philosophers apply their frameworks to assess uploaded work, offering critiques for longer documents or rewrites for shorter ones (under 500 words).
- **CRITICAL PROMPT REDESIGN - Active Reasoning vs Recitation**: Completely redesigned system prompts and RAG injection to transform philosophers from "archival textbook entries" to "living thinkers." New prompt establishes 4-stage reasoning workflow (parse structure → identify principles → reason through → optionally cite), explicitly contrasts archival vs active reasoning, demotes quotes from requirements to optional evidence, and reframes RAG chunks as "conceptual briefing material" rather than "passages to quote." Goal: philosophers now apply frameworks to novel contexts instead of reciting doctrine.
- **Compare Thinkers Download Feature**: Added download button to Compare Thinkers modal allowing users to export both responses as a formatted text file with questions and answers clearly labeled
- **Russell The Analysis of Mind Training**: Added "The Analysis of Mind" (234 chunks, 89,179 words) - Russell's seminal 1921 work on philosophy of mind and psychology covering consciousness, neutral monism, behaviorism, introspection, memory, belief, desire, and the relationship between mind and matter. Total Russell corpus now 441 chunks across 5 major works.
- **Marden The Secret of Achievement Training**: Added "The Secret of Achievement" (134 chunks, 51,256 words) - Marden's comprehensive guide to success principles, personal development, optimism, positive thinking, cultivating will-power and character, New Thought philosophy. Total Marden corpus now 416 chunks across 5 major works.
- **Kuczynski AI & Philosophy Training Complete**: Added "AI and Philosophy: Logic, Epistemology, Mind & System L" (82 chunks, 31,451 words) - comprehensive treatise on AI Logic vs Classical Logic, System L (pattern recognition, meta-reasoning, defeasible inference), AI solutions to Gettier problem and induction, critique of Computational Theory of Mind, LLM evidence for semantics/grammar, Universal Grammar reconciliation with Connectionism, AI architecture and theories of self/truth/explanation
- **CRITICAL PRODUCTION BUG FIXED (v2)**: Resolved persistent race condition where streaming responses vanished in deployment. Root cause: refetch completed BEFORE server committed message to database, overwriting cache with old data. Fix: Keep message visible as `pendingAssistantMessage` until refetch confirms persistence (message count increase + content match), preventing blank screen during database write delay. Uses local accumulators to avoid stale state closure bugs. Applied to both main chat and figure chat.

## Overview
"Ask A Philosopher" is a philosophical Q&A application designed for deep philosophical discourse with 44 philosophical and literary figures. It leverages their actual writings and advanced AI to provide nuanced and contextually rich responses. The platform integrates philosophical papers as foundational texts, enabling the AI to reason and adapt based on user sophistication. It supports multi-author conversations through a Retrieval-Augmented Generation (RAG) system, ensuring each figure's responses are grounded in their respective works. The project aims to offer an accessible and engaging way to explore complex philosophical ideas and literary works, with J.-M. Kuczynski as the default philosopher.

## User Preferences
- **Response Length Control**: User can type desired response length in words, or leave blank for Auto mode where AI chooses optimal length based on question complexity
- **Quote Frequency Guidance**: User can adjust discretionary quote usage with three levels: Low (deploy quotes rarely, only when critical), Normal (use quotes occasionally when they advance arguments), High (use quotes 1-2 times per response when tactically useful). Quotes are never mandatory - they're weapons deployed only when they strengthen the philosophical attack.
- **Paper Writing Mode**: Toggle to request formal philosophical papers with academic conventions, proper argumentation, and scholarly language
- **Variation**: Never give the same answer twice.
- **Direct Attack Mandate**: All figures attack problems immediately without preambles, commit decisively without hedging, name specific targets rather than vague references, show mechanisms through visible reasoning, reframe confused questions by rejecting false premises, and deploy quotes as logical weapons rather than decoration.

## System Architecture
The application features a 3-column layout without authentication, providing direct access to the chat interface.

### UI/UX Decisions
- **Layout**: A 3-column layout with a far-left column for philosophical figures, a narrow middle sidebar for settings, and a right area for the main chat.
- **Accessibility**: No login required; minimal, visible settings (Response Length, Write a Paper toggle).
- **Visuals**: Animated Kuczynski icon, AI-generated portrait avatars for figures, minimalistic design with elegant typography, and dark mode support.
- **"Talk with X" Feature**: Clickable philosophical figures with avatars for personalized conversations.
- **"Compare Thinkers" Feature**: Allows selecting two philosophers for a side-by-side comparison of their real-time, streaming responses to the same question.

### Technical Implementations
- **Frontend**: React, TypeScript, Wouter, TanStack Query, Shadcn UI, and Tailwind CSS.
- **Backend**: Express.js with Node.js and Drizzle ORM.
- **AI Interaction**: Anthropic Claude Sonnet 4.5 is the primary AI operating at 0.7 temperature. Figures are configured for **Aggressive Direct Reasoning**: (1) Attack immediately without preambles - no "To address this..." openings (2) Commit decisively without hedging - no "Perhaps..." or "Might..." (3) Name specific targets - engage actual thinkers, not "many philosophers argue" (4) Show mechanisms through visible step-by-step reasoning (5) Reframe confused questions by rejecting false premises first (6) Deploy quotes as logical weapons only when they advance arguments. Philosophers operate as fully realized, maximally intelligent versions who use their doctrines as frameworks for attacking novel problems, not as textbook entries reciting views. Conversation history maintained; philosophers can cite their own works by title.
- **Streaming**: Server-Sent Events (SSE) for real-time word-by-word AI response streaming.
- **Quote Verification**: Comprehensive normalization for quote matching across text formats.
- **Settings**: Users can control response length, quote frequency, and toggle paper writing mode.
- **Paper Writing Feature**: Allows philosophers to write original papers (up to 1500 words) in their authentic voice, utilizing RAG retrieval, with streaming generation and text file download options.
- **Guest User Management**: Session-based storage with auto-generated guest user IDs maintains state without authentication.
- **RAG System**: Papers are chunked, embedded into 1536-dimension vectors, and stored in a PostgreSQL database with pgvector. Semantic search retrieves relevant chunks for the LLM.
- **Multi-Author RAG System**: Maintains separate vector embeddings for each author, filtering searches by author ID to ensure responses are grounded in their specific works.
- **Integrated Philosophical and Literary Works**: Extensive works from 44 philosophers and literary figures are integrated.

## External Dependencies
- **AI Providers**: Anthropic Claude Sonnet 4.5, OpenAI GPT-4o, DeepSeek, Perplexity.
- **Database**: PostgreSQL (Neon) with pgvector extension.
- **Embeddings**: OpenAI `text-embedding-ada-002`.